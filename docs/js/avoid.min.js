function removeFromArray(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)}function removeFromArrayOnCondition(e,t){for(var r=0;r<e.length;r++)t(e[r],r)&&e.splice(r,1)}function arrayCondition(e,t){for(var r=0;r<e.length;r++)if(t(e[r],r))return!0;return!1}function obj2arr(e){var t=[];return e.onEach(function(e,r){t.push({key:e,value:r})}),t}function cloneObj(e){return JSON.parse(JSON.stringify(e))}function copyProps(e,t){return t.onEach(function(t,r){e[t]=r}),e}function merge_options(e,t){var r={};for(var o in e)r[o]=e[o];for(var o in t)r[o]=t[o];return r}function getBool(e){if(void 0===e||null===e)return!1;if(!0===e||!1===e)return e;switch(e.toString().toLowerCase().trim()){case"true":case"yes":case"1":case"on":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}}function OR(e,t){return null!==e&&void 0!==e?e:t}Array.prototype.onEach=function(e,t){for(var r,o=this.length,i=0;i<this.length;i++,o--){var n=e(this[i],i,o-1);if(!1===n)break;t&&(r=t(n,r))}return r},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},Array.prototype.removeConditional=function(e){for(var t=0;t<this.length;t++)e(this[t],t)&&this.splice(t,1)},Array.prototype.condition=function(e){for(var t=0;t<this.length;t++)if(e(this[t],t))return!0;return!1},Array.prototype.shuffle=function(){var e,t,r=this.length;if(0==r)return this;for(;--r;)e=Math.floor(Math.random()*(r+1)),t=this[r],this[r]=this[e],this[e]=t;return this},Array.prototype.trim=function(e){return this.map(function(t){return t.trimChar(e)})},document.contains||(document.contains=function(e){for(;e.parentNode;)e=e.parentNode;return e===document}),Object.prototype.toArray=function(){var e=[];return this.onEach(function(t,r){e.push({key:t,value:r})}),e},Object.prototype.onEach=function(e,t){var r,o=0;for(var i in this)if(this.hasOwnProperty(i)){var n=e(i,this[i],o);if(!1===n)break;t&&(r=t(n,r)),o++}return r},Object.prototype.clone=function(){return JSON.parse(JSON.stringify(this))},Object.prototype.copy=function(e){e.onEach(function(e,t){this[e]=t})},Object.prototype.merge=function(e){var t={};for(var r in this)t[r]=this[r];for(var r in e)t[r]=e[r];return t},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},String.prototype.splitTrim=function(e){return this.split(e).trim()},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},String.prototype.trimChar=function(e){e=this.escapeRegExp(e);var t=new RegExp("^["+e+"]+|["+e+"]+$","g");return this.replace(t,"")},String.prototype.isNumeric=function(){return parseFloat(this)==this},String.prototype.toAttrSelector=function(){return"["+this+"]"},AvoidJS.$.OR=function(e,t){return null!==e&&void 0!==e?e:t},AvoidJS.$.getBool=function(e){if(void 0===e||null===e)return!1;if(!0===e||!1===e)return e;switch(e.toString().toLowerCase().trim()){case"true":case"yes":case"1":case"on":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}};var AvoidJS={conf:{},core:{Logger:{},Threader:{},Timeout:{}},Storage:{},Remember:{},Eventer:{},Events:{},Templater:{},TemplatesManager:{},ui:{Effects:{},Manager:{},Format:{}},conf:{version:"0.0",attrs:{templater:{template:"avj-template",action:"avj-action",digested:"avj-digested",preserveContent:"avj-preserve-content",contentPreserved:"avj-content-preserved"},macros:{def:"avj-macros",apply:function(e){return"avj-apply-"+e},applied:function(e){return"avj-"+e+"-applied"}},actions:{formValidation:"avj-form-validation"}}}};AvoidJS.Logger={options:{info:!1,error:!0},info:function(e){this.options.info&&console.log(e)},error:function(e){this.options.error&&console.log(e)}},AvoidJS.Remember={my:{},defaults:{},typesSupport:{json:{to:function(e){return JSON.stringify(e)},from:function(e,t){if(e)try{return JSON.parse(e)}catch(e){}return t}}},types:{userChatsFilter:"json"},please:function(e,t){this.types[e]&&(t=this.typesSupport[this.types[e]].to(t)),AvoidJS.Storage.save(e,t)},that:function(e,t){var r=AvoidJS.Storage.get(e);return"undefined"===r||void 0===r||null===r?(r=OR(t,AvoidJS.Remember.defaults[e]),AvoidJS.Remember.please(e,r)):this.types[e]&&(r=this.typesSupport[this.types[e]].from(r,t)),r},forget:function(e){AvoidJS.Storage.remove(e)}},AvoidJS.Storage={types:{},storage:null,init:function(e){this.storage=e},save:function(e,t){this.storage.save(e,t)},get:function(e){return this.storage.get(e)},remove:function(e){this.storage.remove(e)}},AvoidJS.core.Threader={putInQueue:function(e,t){AvoidJS.core.Timeout.set(function(){var r=e();t&&t(r)},1)},run:function(e,t){if(t||(t={callback:null,inQ:!1}),t.inQ)AvoidJS.core.Timeout.set(function(){var r=e();t.callback&&t.callback(r)},1);else{var r=e();t.callback&&t.callback(r)}}},AvoidJS.core.Timeout=new function(){this.reset=function(e){null!=e&&(clearTimeout(e),e=null)},this.set=function(e,t){var r=setTimeout(function(){e(),r=null},t);return r}},AvoidJS.Storage.types.CookieStorage={get:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},save:function(e,t){return this._save(e,t,1/0,"/")},_save:function(e,t,r,o,i,n){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(r)switch(r.constructor){case Number:a=r===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+r;break;case String:a="; expires="+r;break;case Date:a="; expires="+r.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+"; domain="+(i||"."+document.domain)+(o?"; path="+o:"/")+(n?"; secure":""),!0},remove:function(e,t,r){if(!this.has(e))return!1;var o=new Date;return o.setTime(-1),document.cookie=encodeURIComponent(e)+"=; expires="+o.toGMTString()+";",!0},has:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,r=0;r<t;r++)e[r]=decodeURIComponent(e[r]);return e}},AvoidJS.Storage.types.LocalStorage={save:function(e,t){window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},remove:function(e){window.localStorage.removeItem(e)}},AvoidJS.Eventer={listeners:[],_subscribersCounter:0,history:{},subscribe:function(e,t,r){r=merge_options({id:null,subtype:null,once:!1,noQ:!1},r),AvoidJS.Events.ifEventSupported(e,function(){AvoidJS.Eventer.listeners[e]||(AvoidJS.Eventer.listeners[e]=[]),r.id||(r.id=AvoidJS.Eventer.generateId(e)),AvoidJS.Logger.info(r.id),AvoidJS.Eventer.listeners[e][r.id]={func:function(e,o,i){if(!r.subtype||r.subtype==i){var n=t(e,o,i);(r.once||!1===n)&&AvoidJS.Eventer.unsubscribe(o,r.id)}},options:r}})},subscribeMulti:function(e,t,r){e.onEach(function(e){AvoidJS.Eventer.subscribe(e,t,r)})},generateId:function(e){var t=0;for(this.listeners[e]||(this.listeners[e]=[]);void 0!==this.listeners[e][e+t];)t++;return e+t},subscribeOnce:function(e,t,r){r=merge_options({once:!0},r),this.subscribe(e,t,r)},unsubscribe:function(e,t){AvoidJS.Logger.info("Unsubscribe: "+t),this.listeners[e]&&this.listeners[e][t]&&delete this.listeners[e][t]},unsubscribeAll:function(e){this.listeners[e]&&(delete this.listeners[e],this.listeners[e]={})},unsubscribeEvery:function(e){e.onEach(function(e){AvoidJS.Eventer.unsubscribeAll(e)})},getListeners:function(e){var t=[];return AvoidJS.Eventer.listeners[e].onEach(function(e,r){t.push(r)}),t},fire:function(e,t,r){r=merge_options({noQ:!1,subtype:""},r),AvoidJS.Events.ifEventSupported(e,function(){AvoidJS.Eventer.history[e]=OR(AvoidJS.Eventer.history[e],{}),AvoidJS.Eventer.history[e][r.subtype]={data:t,options:r},AvoidJS.Eventer.getListeners(e).onEach(function(o){r.noQ||o.options.noQ?o.func(t,e,r.subtype):AvoidJS.core.Threader.putInQueue(function(){o.func(t,e,r.subtype)})})})},refire:function(e,t){t||(t=""),AvoidJS.Eventer.history[e]&&AvoidJS.Eventer.history[e][t]&&AvoidJS.Eventer.fire(e,AvoidJS.Eventer.history[e][t].data,AvoidJS.Eventer.history[e][t].options)},wasFired:function(e,t){return t||(t=""),AvoidJS.Eventer.history[e]&&AvoidJS.Eventer.history[e][t]}},AvoidJS.Events={registeredEvents:{},registerEvents:function(e){var t=null;if(AvoidJS.Events.onEach(function(r,o){o===e&&(t=r)}),!t)throw"Cannot register events - no namespace found.";e.onEach(function(r,o){e[r]=[t,r].join("."),AvoidJS.Events.registeredEvents[e[r]]=[e[r]]})},isEventSupported:function(e){return void 0!==AvoidJS.Events.registeredEvents[e]},ifEventSupported:function(e,t){AvoidJS.Events.isEventSupported(e)?t():AvoidJS.Logger.error("EventsManager: event with name '"+e+"' not supported.")}},AvoidJS.Templater.actions={void:{perform:function(){}},trigger:{perform:function(e){e.getProp("action","").splitTrim(",").onEach(function(t){AvoidJS.Eventer.fire(AvoidJS.Events.Templater.triggerAction,{data:e.getData(),action:e},{noQ:!0,subtype:t})})}},retrigger:{perform:function(e){e.getProp("action","").splitTrim(",").onEach(function(e){AvoidJS.Eventer.refire(AvoidJS.Events.Templater.triggerAction,e)})}},execute:{perform:function(e){e.getProp("func","").splitTrim(";").onEach(function(t){new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateExpression(t)})}},fire:{perform:function(e){return AvoidJS.Eventer.fire(e.getProp("event"),null,{noQ:!0,subtype:e.getProp("subtype")})}},condition:{perform:function(e){var t=e.getProp("expr",""),r=e.getProp("true"),o=e.getProp("false");AvoidJS.$.getBool(new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateCondition(t))?r&&AvoidJS.Templater.processActions(r,e.el,e.getData(),e.parentEl):o&&AvoidJS.Templater.processActions(o,e.el,e.getData(),e.parentEl)}},include:{perform:function(e){AvoidJS.ui.DOM.setHTML(e.el,TemplatesManager.getHTML(e.getProp("template"))),AvoidJS.Templater.digest(e.el,e.getData())}},draw:{_pre:function(e){e.html=AvoidJS.ui.DOM.getHTML(e.el);var t=e.getProp("placeholder");t&&AvoidJS.ui.DOM.setHTML(e.el,t)},perform:function(e){return new AvoidJS.Templater.Temparser(AvoidJS.Templater.actions.draw.__getContent(e),e.getData(),null).format()},_post:function(e,t){getBool(e.getProp("clear",!0))&&AvoidJS.ui.DOM.clearEl(e.el);var r=e.getProp("above",!1);AvoidJS.ui.DOM.addNodeFromHTML(e.el,t,r),AvoidJS.Templater.digest(e.el,e.getData())},__getContent:function(e){if(e.getProp("template"))return TemplatesManager.getHTML(e.getProp("template"));if(e.getProp("page"))return AppPage.getPageHTML(e.getProp("page"));if(e.getProp("content"))return e.getProp("content");var t=e.html;return AvoidJS.Templater.preservedContent.onEach(function(r){if(r.el===e.el)return t=r.content,!1}),t}},drawEvery:{_pre:function(e){return AvoidJS.Templater.actions.draw._pre(e)},perform:function(e){var t={clear:getBool(e.getProp("clear",!0)),alias:e.getProp("alias","val"),sep:e.getProp("sep",""),sepEvery:parseInt(e.getProp("sepEvery",1)),isAbove:e.getProp("above",!1),every:e.getProp("every"),everyIf:e.getProp("everyIf",!1),everyAfter:e.getProp("everyAfter",!1),ifNone:e.getProp("ifNone")},r=new AvoidJS.Templater.Temparser(null,e.getData()).evaluateExpression(t.every);if(r.length>0)return t.clear&&AvoidJS.ui.DOM.clearEl(e.el),r.onEach(function(r,o,i){var n={parent:e.getData(),val:r,index:o};if(n[t.alias]=r,e.setData("_item",n),!t.everyIf||getBool(new AvoidJS.Templater.Temparser(null,n,null).evaluateCondition(t.everyIf))){var a=i>0&&(o+1)%t.sepEvery==0?t.sep:"",s=new AvoidJS.Templater.Temparser(AvoidJS.Templater.actions.draw.__getContent(e),n,null).format();AvoidJS.core.Threader.run(function(){AvoidJS.ui.DOM.addNodeFromHTML(e.el,s+a,t.isAbove),AvoidJS.Templater.digest(e.el,n),t.everyAfter&&AvoidJS.Templater.processActions(t.everyAfter,e.el,n,e.parentEl)},{inQ:!1,callback:null})}},function(e,t){return OR(t,"")+e});t.ifNone&&AvoidJS.ui.DOM.setHTML(e.el,t.ifNone)}},setHTML:{perform:function(e){AvoidJS.ui.DOM.setHTML(e.el,e.getProp("value"))}},addHTML:{perform:function(e){AvoidJS.ui.DOM.addNodeFromHTML(e.el,e.getProp("value"),e.getProp("above"))}},clearHTML:{perform:function(e){AvoidJS.ui.DOM.clearEl(e.el,e.getProp("value"))}},show:{perform:function(e){AvoidJS.ui.DOM.showEl(e.el,e.getProp("display"))}},hide:{perform:function(e){AvoidJS.ui.DOM.hideEl(e.el)}},enable:{perform:function(e){AvoidJS.ui.DOM.enEl(e.el)}},disable:{perform:function(e){AvoidJS.ui.DOM.disEl(e.el)}},focus:{perform:function(e){AvoidJS.ui.DOM.setFocus(e.el)}},placeholder:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"placeholder",e.getProp("text"))}},checked:{perform:function(e){AvoidJS.ui.DOM.setChecked(e.el,getBool(e.getProp("value")))}},selected:{perform:function(e){AvoidJS.ui.DOM.setSelectedOption(e.el,e.getProp("value"))}},addClass:{perform:function(e){AvoidJS.ui.DOM.addClassToEl(e.el,e.getProp("class"))}},removeClass:{perform:function(e){AvoidJS.ui.DOM.removeClassFromEl(e.el,e.getProp("class"))}},switchClass:{perform:function(e){AvoidJS.ui.DOM.switchClassOnEl(e.el,e.getProp("class"))}},setValue:{perform:function(e){AvoidJS.ui.DOM.setValue(e.el,e.getProp("value",""))}},resetValue:{perform:function(e){AvoidJS.ui.DOM.resetValue(e.el)}},select:{perform:function(e){AvoidJS.ui.DOM.select(e.el)}},restorableValue:{perform:function(e){var t=e.getProp("storageKey");AvoidJS.ui.DOM.setValue(e.el,AvoidJS.Remember.that(t,AvoidJS.ui.DOM.getValue(e.el))),AvoidJS.Eventer.subscribeOnce(AvoidJS.Events.PageDirector.pageUnloaded,function(){AvoidJS.Remember.please(t,AvoidJS.ui.DOM.getValueTrimmed(e.el))})}},rememberGlob:{perform:function(e){AvoidJS.Remember.please(e.getProp("remember"),AvoidJS.Templater.Glob.get(e.getProp("glob")))}},setSrc:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"src",e.getProp("value"))}},setHref:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"href",e.getProp("href"))}},toggleDisplay:{perform:function(e){AvoidJS.ui.DOM.toggleElDisplay(e.el,e.getProp("display"))}},adaptHeight:{perform:function(e){AvoidJS.ui.DOM.adaptElHeight(e.el)}},autoHeight:{perform:function(e){AvoidJS.ui.DOM.adaptiveHeight(e.el)}},scrollTop:{perform:function(e){AvoidJS.ui.DOM.scrollTop(e.el)}},scrollIntoView:{perform:function(e){AvoidJS.ui.DOM.scrollIntoView(e.el)}},scrollDown:{perform:function(e){AvoidJS.ui.DOM.scrollDown(e.el)}},preserveScroll:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"temp-js-preserveScroll-value",e.el.scrollHeight-e.el.scrollTop)}},restoreScroll:{perform:function(e){var t=AvoidJS.ui.DOM.getElAttr(e.el,"temp-js-preserveScroll-value");void 0!==t&&(AvoidJS.ui.DOM.setScrollTop(e.el,e.el.scrollHeight-t),AvoidJS.ui.DOM.removeElAttr(e.el,"temp-js-preserveScroll-value"))}},noScrollingPropagation:{perform:function(e){AvoidJS.ui.DOM.preventScrollPropagation(e.el)}},processForm:{perform:function(e){var t={},r=new FormData(e.el);e.el.querySelectorAll("[name]").onEach(function(e){var r=AvoidJS.ui.DOM.getElAttr(e,"name"),o=AvoidJS.ui.DOM.getValue(e);t[r+"_array"]||(t[r+"_array"]=[]),"checkbox"===AvoidJS.ui.DOM.getElAttr(e,"type")?e.checked?(t[r]="on",t[r+"_array"].push(o)):t[r]="off":(t[r]=o,t[r+"_array"].push(o))}),e.setData("formData",t),e.setData("form",r);var o=!0;e.el.querySelectorAll(AvoidJS.conf.attrs.actions.formValidation.toAttrSelector()).onEach(function(t){var r=AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.actions.formValidation),i=new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateExpression(r)(AvoidJS.ui.DOM.getValueTrimmed(t));if(!i.valid)return o=!1,PageDirector.showOperationError(i.message),!1});var i=e.getProp("ifValid");o&&i&&AvoidJS.Templater.processActions(i,e.el,e.getData(),e.parentEl)}},fadeOut:{perform:function(e){UIEffects.fadeOut(e.el)}},setStyle:{perform:function(e){AvoidJS.ui.DOM.setStyle(e.el,e.getProp("style"),e.getProp("value"))}},json2html:{perform:function(e){AvoidJS.ui.DOM.json2html(e.el)}}},AvoidJS.Events.UI={hidePopovers:"hidePopovers"},AvoidJS.Events.registerEvents(AvoidJS.Events.UI),AvoidJS.Templater.MacrosManager={attrs:{macros:"data-js-macros"},available:{},retrive:function(e){e.querySelectorAll(AvoidJS.conf.attrs.macros.def.toAttrSelector()).onEach(function(e){if(!AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.digested)){var t=AvoidJS.ui.DOM.getElAttr(e,AvoidJS.Templater.MacrosManager.attrs.macros);AvoidJS.Templater.MacrosManager.available[t]=new AvoidJS.Templater.Macros(t,e),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.digested,!0)}})}},AvoidJS.Templater.Macros=function(e,t){this.name=e,this.attr=AvoidJS.conf.attrs.macros.apply(e),this.el=t,this.actions=AvoidJS.Templater.ActionsParser.retriveNameWithAlliases(AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.templater.action))},AvoidJS.Templater.Temparser=function(e,t,r){var o=this;return this.content=e,this.name=r,this.data=t,this.format=function(){return this.content.replace(new RegExp("{{(.[^{{]+)}}","g"),function(e,t){return OR(o.evaluate(t,e),"")}).trim()},this.evaluate=function(e,t){var r=null,i=e.splitTrim("?");if(i.length>1){var n=i[0],a=i[1],s=null,l=i[1].splitTrim(":");l.length>1&&(a=l[0],s=l[1]),o.evaluateCondition(n)?a&&(r=o.evaluate(a)):s&&(r=o.evaluate(s))}else r=o.evaluateCondition(i[0],t);return r},this.evaluateCondition=function(e){var t=!1,r=e.splitTrim(/\sand\s/),i=e.splitTrim(/\sor\s/);if(r.length>1)for(var n=0;n<r.length;n++){if(!o.evaluateCondition(r[n])){t=!1;break}t=!0}else if(i.length>1){for(i=e.splitTrim(" or "),n=0;n<i.length;n++)if(o.evaluateCondition(i[n])){t=!0;break}}else if(null===e.match(/^[\"'].*[\"']$/g)){var a=[];AvoidJS.Templater.Temparser.comparisons._map.onEach(function(e,t){a.push(t)});var s=e.match("(.+)("+a.join("|")+")(.+)");if(s){s=s.trim();var l=o.evaluateExpression(s[1]),c=o.evaluateExpression(s[3]),u=AvoidJS.Templater.Temparser.comparisons._find(s[2]);u?t=AvoidJS.Templater.Temparser.comparisons[u](l,c):AvoidJS.Logger.error("Tempater.comparison: ["+s[1]+"] not found.")}else t=o.evaluateExpression(e,!1)}else t=e.replace(/^[\"']|[\"']$/g,"");return t},this.evaluateExpression=function(e,t){var r=t,i=e.match(/(.[^(]+)\(?/),arguments=e.match(/[(](.*)[)]/);if(i&&i.length>0)if(arguments&&arguments.length>0){var n=o.parseDataExpression(i[1],void 0),a=o.parseExpressionArguments(arguments[1]);void 0!==n.value&&(r=n.value.apply(n.obj,a))}else r=o.parseValue(i[1],t);else r=o.parseValue(e,t);return r},this.parseDataExpression=function(e,t){var r={obj:null,value:t};if(e){var i=o.data;e.splitTrim(".").onEach(function(n,a){null!==i&&void 0!==i&&void 0!==i[n]?(r.obj=i,r.value=i=i[n]):0==a&&void 0!==window[n]?(r.obj=window,r.value=i=window[n]):(AvoidJS.Logger.error("AvoidJS.Templater.Temparser: ["+o.name+"] Cannot find data for ["+e+"]"),AvoidJS.Logger.error("== Defails =="),AvoidJS.Logger.error("Data Available: "),AvoidJS.Logger.error(o.data),AvoidJS.Logger.error("Content: "),AvoidJS.Logger.error(o.content),AvoidJS.Logger.error("== End =="),r.value=t)})}return r},this.parseExpressionArguments=function(e){var t=[];e&&e.split(",").onEach(function(e){t.push(o.parseValue(e))});return t},this.parseValue=function(e,t){var r=t;if(e)if(null!==(e=e.trim().replace(/&quot;/g,'"')).match(/^[\"']|[\"']$/g))r=e.replace(/^[\"']|[\"']$/g,"");else if(e.isNumeric())r=e;else switch(e){case"true":r=!0;break;case"false":r=!1;break;case"this":r=o.data;break;case"null":r=null;break;default:r=o.parseDataExpression(e,t).value}return r},this},AvoidJS.Templater.Temparser.comparisons={_find:function(e){for(var t in this._map)if(e==this._map[t])return t},_map:{notEqq:"!==",notEq:"!=",eqq:"===",eq:"==",moreOrEq:">=",more:">",lessOrEq:"<=",less:"<"},eq:function(e,t){return e==t},eqq:function(e,t){return e===t},notEq:function(e,t){return e!=t},notEqq:function(e,t){return e!==t},more:function(e,t){return parseFloat(e)>parseFloat(t)},moreOrEq:function(e,t){return parseFloat(e)>=parseFloat(t)},less:function(e,t){return parseFloat(e)<parseFloat(t)},lessOrEq:function(e,t){return parseFloat(e)<=parseFloat(t)}},AvoidJS.Templater={attrs:{action:"data-js-action",digested:"data-js-digested",preserveContent:"data-js-preserve-content",contentPreserved:"data-js-content-preserved",macrosApplied:function(e){return"data-js-"+e+"-applied"}},preservedContent:[],init:function(){AvoidJS.Templater.GarbageCollector.init()},digest:function(e,t){TemplatesManager.retrieveTemplates(e),AvoidJS.Templater.MacrosManager.retrive(e),e.querySelectorAll(AvoidJS.conf.attrs.templater.preserveContent.toAttrSelector()).onEach(function(e){AvoidJS.ui.DOM.elHassAttr(e,AvoidJS.conf.attrs.templater.contentPreserved)||(AvoidJS.Templater.preservedContent.push({el:e,content:AvoidJS.ui.DOM.getHTML(e)}),AvoidJS.ui.DOM.clearEl(e),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.contentPreserved,!0))}),AvoidJS.Templater.MacrosManager.available.onEach(function(r,o){e.querySelectorAll("["+o.attr+"]").onEach(function(e){if(0==AvoidJS.ui.DOM.elHassAttr(e,AvoidJS.conf.attrs.macros.applied(r))){var i=AvoidJS.Templater.MacrosManager.available[r];i.actions.onEach(function(r){var n=new AvoidJS.Templater.Action(r.name,e,t,r.alias,i.el,{macros:{value:AvoidJS.ui.DOM.getElAttr(e,o.attr)}});AvoidJS.Templater.runAction(n)}),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.macros.applied(r),!0)}})}),e.querySelectorAll(AvoidJS.conf.attrs.templater.action.toAttrSelector()).onEach(function(e){AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.digested)||(AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.digested,!0),AvoidJS.Templater.processActions(AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.action),e,t))}),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.elementDigested,{el:e}),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.garbageCollectorDeactivateZombies)},processActions:function(e,t,r,o){AvoidJS.Templater.ActionsParser.retriveActions(e,t,r,o).onEach(function(e){AvoidJS.Templater.runAction(e)})},runAction:function(e){AvoidJS.Templater.actions[e.action]||AvoidJS.Logger.error("Action ["+e.action+"] is not supported. "),AvoidJS.Templater.GarbageCollector.addAction(e),AvoidJS.Templater.performPreAction(e),e.wait?AvoidJS.Templater.wait._process(e):AvoidJS.Templater.perform(e)},performPreAction:function(e){AvoidJS.Templater.actions[e.action]._pre&&AvoidJS.Templater.actions[e.action]._pre(e)},perform:function(e){if(getBool(e.getProp("debug")),document.contains(e.el)){if(e.prepare(),!e.if||getBool(new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateCondition(e.if))){AvoidJS.Eventer.fire(AvoidJS.Events.Templater.performingAction,{action:e}),e.before&&AvoidJS.Templater.processActions(e.before,e.el,e.getData(),e.parentEl);var t=AvoidJS.Templater.actions[e.action].perform(e);AvoidJS.Templater.actions[e.action]._post&&AvoidJS.Templater.actions[e.action]._post(e,t),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.actionPerfromed,{action:e}),e.after&&AvoidJS.Templater.processActions(e.after,e.el,e.getData(),e.parentEl)}else e.else&&AvoidJS.Templater.processActions(e.else,e.el,e.getData(),e.parentEl);e.awaits||(e.active=!1)}else e.valid=!1;AvoidJS.Eventer.fire(AvoidJS.Events.Templater.garbageCollectorCleanUp)},wait:{_process:function(e){AvoidJS.Templater.ActionsParser.retriveNameWithAlliases(e.wait).onEach(function(t){AvoidJS.Templater.wait[t.name]?AvoidJS.Templater.wait[t.name](e,t.alias):AvoidJS.Logger.error("When type ["+t.name+"] is not supported. ")})},now:function(e,t){AvoidJS.Templater.perform(e)},event:function(e,t){var r=this,o=e.getProp(t+"-when").splitTrim(",");this.subscribe=function(e,t,o){var i={repeat:t.getProp(o+"-repeat","repeat"),subtype:t.getProp(o+"-subtype")};AvoidJS.Eventer.subscribe(e,function(e,n,a){t.setData("event",e),t.setData("_event",{name:n,subtype:a}),t.awaits="repeat"===i.repeat,AvoidJS.Templater.perform(t),t.valid&&t.awaits&&r.subscribe(n,t,o)},{subtype:i.subtype,once:!0})},o.onEach(function(o){r.subscribe(o,e,t)})},trigger:function(e,t){var r=e.getProp(t+"-repeat","repeat");AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.triggerAction,function(o,i,n){e.setData("event",o.data),e.setData("trigger",o.action),e.setData("_event",{name:i,subtype:n}),e.awaits="repeat"===r,AvoidJS.Templater.perform(e),e.valid&&e.awaits&&AvoidJS.Templater.wait.trigger(e,t)},{subtype:e.id,once:!0})},user:function(e,t){var r={when:e.getProp(t+"-when"),noDef:e.getProp(t+"-noDef"),confirm:e.getProp(t+"-confirm")};AvoidJS.ui.DOM.addEvent(e.el,r.when,function(t){r.noDef&&t.preventDefault(),e.setData("_event",t),r.confirm?PageAlerts.confirm(r.confirm,function(){AvoidJS.Templater.perform(e)}):AvoidJS.Templater.perform(e)})},timeout:function(e,t){AvoidJS.core.Timeout.set(function(){AvoidJS.Templater.perform(e)},e.getProp(t))}}},AvoidJS.Templater.Action=function(e,t,r,o,i,n){var a=this;this.valid=!0,this.active=!0,this.awaits=!1,this.el=t,this.action=e,this.alias=OR(o,e),this.parentEl=i,this.prepare=function(){this.parentEl&&this._retrieveDataAttrbs(this.parentEl),this._retrieveDataAttrbs(this.el),this.setData("_global",AvoidJS.Templater.Glob.data),this.setData("_elContent",AvoidJS.ui.DOM.getHTML(t).trim())},this._retrieveDataAttrbs=function(e){var t="data-js-"+this.alias.toLowerCase()+"-data-";e.attributes.onEach(function(e){if(0===e.name.indexOf(t)){var r=e.name.replace(t,"").split("-")[0];a.data[r]=a.getProp("data-"+r)}})},this.getProp=function(e,t){e=e.toLowerCase();var r=this._retrievePropFromEl(this.el,e);return null===r&&this.parentEl&&(r=this._retrievePropFromEl(this.parentEl,e)),OR(r,t)},this._retrievePropFromEl=function(e,t){var r=null,o="js-"+this.alias+"-"+t,i=AvoidJS.ui.DOM.getElData(e,o+"-expr");return i?r=new AvoidJS.Templater.Temparser(null,this.getData()).evaluate(i):AvoidJS.ui.DOM.elHasData(e,o)&&(r=AvoidJS.ui.DOM.getElData(e,o)),r},this.getData=function(e){return new AvoidJS.Templater.Temparser(null,this.data).parseValue(OR(e,this.context))},this.setData=function(e,t){this.data[e]=t},this.data={data:OR(r,{}),action:a},n&&n.onEach(function(e,t){a.data[e]=t}),this.context=this.getProp("context","data"),this.id=this.getProp("id",this.action),this.wait=this.getProp("wait"),this.if=this.getProp("if"),this.else=this.getProp("else"),this.before=this.getProp("before"),this.after=this.getProp("after")},AvoidJS.Templater.ActionsParser={retriveActions:function(e,t,r,o){var i=[];return this.retriveNameWithAlliases(e).onEach(function(e){i.push(new AvoidJS.Templater.Action(e.name,t,r,e.alias,o))}),i},retriveNameWithAlliases:function(e){var t=[];return e.splitTrim(",").onEach(function(e){var r=e,o=r,i=e.split("=");i.length>1&&(o=i[0],r=i[1]),t.push({name:r,alias:o})}),t}},AvoidJS.Templater.Glob={data:{},get:function(e,t,r){var o=r;return this.data[e]?(o=this.data[e],t&&(o=this.data[e][t])):t?this.set(e,t,o):this.data[e]=o,o},set:function(e,t,r){this.data[e]||(this.data[e]={}),this.data[e][t]=r}},AvoidJS.Templater.GarbageCollector={activeActions:[],init:function(){AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.garbageCollectorDeactivateZombies,function(){AvoidJS.Templater.GarbageCollector.deactivateZombies()}),AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.garbageCollectorCleanUp,function(){AvoidJS.Templater.GarbageCollector.collectGarbage()})},addAction:function(e){this.activeActions.push(e)},deactivateZombies:function(){this.activeActions.onEach(function(e,t){0==document.contains(e.el)&&(e.valid=!1,e.active=!1)})},collectGarbage:function(){for(var e=this.activeActions.length;e--&&-1!==e;)!1===this.activeActions[e].active&&this.activeActions.splice(e,1)}},AvoidJS.Events.Templater={triggerAction:"triggerAction",elementDigested:"elementDigested",performingAction:"performingAction",actionPerfromed:"actionPerfromed",garbageCollectorDeactivateZombies:"garbageCollectorDeactivateZombies",garbageCollectorCleanUp:"garbageCollectorCleanUp"},AvoidJS.Events.registerEvents(AvoidJS.Events.Templater),AvoidJS.Templater.Manager=new function(){var e=this;this.loadedTemplates={},this.templateRelations={},this.attrs={declaration:"data-js-template"},this.retrieveTemplates=function(t,r){t.querySelectorAll(AvoidJS.conf.attrs.templater.template.toAttrSelector()).onEach(function(t){e.retrieveTemplate(t,r)})},this.retrieveTemplate=function(t,r){var o=AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.templater.template);void 0===e.loadedTemplates[o]&&(e.retrieveTemplates(t,r),e.loadedTemplates[o]=AvoidJS.ui.DOM.getHTML(t),r&&(e.templateRelations[r]=o),AvoidJS.ui.DOM.removeEl(t))},this.getHTML=function(e){if(void 0!==this.loadedTemplates[e])return this.loadedTemplates[e];throw"Cannot find template: '"+e+"'"},this.format=function(e,t){return new AvoidJS.Templater.Temparser(this.getHTML(e),t,e).format()}},AvoidJS.ui.DOM=new function(){var e=this;this.appendCSS=function(e,t){var r=document.createElement("style");r.type="text/css",r.innerHTML=t,e.appendChild(r)},this.appendJS=function(e,t){var r=document.createElement("script");r.type="text/javascript",r.innerHTML=t,e.appendChild(r)},this.appendJSsrc=function(e,t){var r=document.createElement("script");r.type="text/javascript",r.src=t,e.appendChild(r)},this.byId=function(e){return document.getElementById(e)},this.getAllElsByClass=function(e){return document.getElementsByClassName(e)},this.getChild=function(e,t){return e.querySelector(t)},this.getChildren=function(e,t){return e.querySelectorAll(t)},this.elHassAttr=function(e,t){return null!==e.getAttribute(t)},this.getElAttr=function(t,r,o){return e.elHassAttr(t,r)?t.getAttribute(r):o},this.setElAttr=function(e,t,r){return e.setAttribute(t,r)},this.removeElAttr=function(e,t){return e.removeAttribute(t)},this.elHasData=function(t,r){return e.elHassAttr(t,"data-"+r)},this.getElData=function(t,r,o){return e.getElAttr(t,"data-"+r,o)},this.setElData=function(t,r,o){return e.setElAttr(t,"data-"+r,o)},this.isElDisplay=function(e,t){return e.style.display==t},this.hideEl=function(e){return e.style.display="none",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elHidden,e),UIManager},this.hideElsList=function(t){return e.getAllElsByClass(t).onEach(function(t){e.hideEl(t)}),UIManager},this.showEl=function(e,t){return e.style.display=t||"block",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elDisplayed,e),UIManager},this.conditionalDisplay=function(t,r,o){r?e.showEl(t,o):e.hideEl(t)},this.showElsList=function(t,r){e.getAllElsByClass(t).onEach(function(t){e.showEl(t,r)})},this.toggleElDisplay=function(e,t,r,o){return void 0===t&&(t="block"),this.isElDisplay(e,t)?(this.hideEl(e),o&&o()):(this.showEl(e,t),r&&r()),e.style.display},this.toggleElsListDisplay=function(t,r){return e.getAllElsByClass(t).onEach(function(t){e.toggleElDisplay(t,r)}),UIManager},this.enEl=function(e){e.disabled=!1},this.disEl=function(e){e.disabled=!0},this.setFocus=function(e){e.focus()},this.getClass=function(e){return e.className},this.setClass=function(e,t){e.className=t},this.getHTML=function(e){return e.innerHTML},this.setHTML=function(e,t){e.innerHTML=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,e),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.addHTML=function(e,t,r){!0===r?e.innerHTML=t+e.innerHTML:e.innerHTML+=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,e),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.addNodeFromHTML=function(t,r,o,i){var n=document.createElement("span");for(e.setHTML(n,r),t.appendChild(n),(o||i)&&o&&(i=t.firstChild);n.childNodes.length>0;)t.insertBefore(n.childNodes[0],i);return e.removeEl(n),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t),t},this.setNodeFromHTML=function(t,r){for(;t.firstChild;)t.removeChild(t.firstChild);e.addNodeFromHTML(t,r),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t)},this.replaceElWithHTML=function(t,r){var o=e.addNodeFromHTML(t.parentNode,r,!1,t);return e.removeEl(t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t),o},this.addChild=function(e,t){e.appendChild(t)},this.setChild=function(t,r){e.clearEl(t),e.addChild(t,r)},this.removeEl=function(e){e.parentNode&&e.parentNode.removeChild(e)},this.elHasParent=function(e,t){for(var r=e;null!=r;){if(r==t)return!0;r=r.parentNode}return!1},this.clearEl=function(t){e.setNodeFromHTML(t,"")},this.json2html=function(t){e.setHTML(t,JSON.parse(e.getHTML(t)))},this.setText=function(e,t){e.textContent=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.getValue=function(e){return e.value},this.getValueTrimmed=function(t){return e.getValue(t).trim()},this.setValue=function(e,t){e.value=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.appendValue=function(e,t){e.value+=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.resetValue=function(e){e.value="",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.select=function(e){e.select()},this.isChecked=function(e){return e.checked},this.setChecked=function(e,t){void 0===t&&(t=!0),e.checked=getBool(t)},this.setSelectedOption=function(t,r){t.options[e.getSelectorIndexOfOption(t,r)].selected=!0},this.getSelectedOption=function(t){return e.getSelectorOptionOfIndex(t,t.options.selectedIndex)},this.getSelectorIndexOfOption=function(t,r){var o=0;return t.options.onEach(function(t,i){e.getValue(t)==r&&(o=i)}),o},this.getSelectorOptionOfIndex=function(t,r){return e.getValueTrimmed(t.options[r])},this.scrollIntoView=function(e,t){if(e.scrollIntoView(),t&&AppInfo.isDesctop()){var r=window.scrollY;r&&window.scroll(0,r-Register.layout.getHeaderHeight(!0))}},this.getScrollTop=function(e){return e.scrollTop},this.setScrollTop=function(e,t){e.scrollTop=t},this.scrollTop=function(t){e.setScrollTop(t,0)},this.scrollDown=function(t){e.setScrollTop(t,t.scrollHeight)},this.getScrollDif=function(e){return e.scrollHeight-e.scrollTop},this.setScrollDif=function(e,t){e.scrollTop=e.scrollHeight-t},this.addClassToEl=function(e,t){if(e.className){this.removeClassFromEl(e,t);var r=e.className.split(" ");r.push(t),e.className=r.join(" ")}else e.className=t},this.removeClassFromEl=function(e,t){if(e.className){var r=t.split(" "),o=e.className.split(" "),i=new Array;o.forEach(function(e){-1===r.indexOf(e)&&i.push(e)}),e.className=i.join(" ")}},this.switchClassOnEl=function(t,r){r.split(" ").onEach(function(r){e.hasClass(t,r)?e.removeClassFromEl(t,r):e.addClassToEl(t,r)})},this.hasClass=function(e,t){return e.className&&e.className.indexOf(t)>-1},this.toggleElClass=function(e,t){this.hasClass(e,t)?this.removeClassFromEl(e,t):this.addClassToEl(e,t)},this.getStyle=function(e,t,r){var o=e.style[t];return r&&(o=parseInt(o)),o},this.setStyle=function(e,t,r,o){o&&(r+=o),e.style[t]=r},this.applyClassToCollectionOnCondition=function(e,t,r){for(var o=0;o<e.length;o++)r?this.addClassToEl(e[o],t):this.removeClassFromEl(e[o],t)},this.addEvent=function(e,t,r){t.split(" ").onEach(function(t){0>["[object Array]","[object NodeList]","[object HTMLCollection]"].indexOf(Object.prototype.toString.call(e))&&(e=[e]),e.onEach(function(e){var o=function(i){!1===r(i,e)&&e.removeEventListener(t,o)};e.addEventListener(t,o)})})},this.addEventNoDefault=function(t,r,o){e.addEvent(t,r,function(e){e.preventDefault(),o(e,t)})},this.removeChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},this.getElComputedStyle=function(e,t,r){var o=window.getComputedStyle(e).getPropertyValue(t);return r?parseInt(o):o},this.preventScrollPropagation=function(t){var r=function(t){var r=this.scrollTop,o=this.scrollHeight,i=e.getElComputedStyle(this,"height",!0),n=t.wheelDelta,a=n>0,s=function(){return t.stopPropagation(),t.preventDefault(),t.returnValue=!1,!1};return!a&&-n>o-i-r?(this.scrollTop=o,s()):a&&n>r?(this.scrollTop=0,s()):void 0};t.addEventListener("mousewheel",r),t.addEventListener("DOMMouseScroll",r)},this.adaptElHeight=function(t){isFinite(e.getStyle(t,"height",!0))||e.setStyle(t,"height",0,"px");for(var r=e.getStyle(t,"height",!0);r>=0;--r)if(e.setStyle(t,"height",r,"px"),t.scrollHeight>t.clientHeight){e.setStyle(t,"height",t.scrollHeight,"px");break}},this.adaptiveHeight=function(t){e.setElData(t,"prev-length",e.getValue(t).length),e.addEvent(t,"input change",function(r){e.getValue(t).length!=e.getElAttr(t,"prev-length")&&(e.adaptElHeight(t),e.setElData(t,"prev-length",e.getValue(t).length))}),e.adaptElHeight(t),AvoidJS.Eventer.subscribe(AvoidJS.Events.DOM.elementContentChanged,function(e){t==t&&AvoidJS.ui.DOM.adaptElHeight(e)})}},AvoidJS.Events.DOM={htmlChanged:"htmlChanged",elementContentChanged:"elementContentChanged",elDisplayed:"elDisplayed",elHidden:"elHidden"},AvoidJS.Events.registerEvents(AvoidJS.Events.DOM),AvoidJS.ui.Effects=new function(){this.fadeOut=function(e){UIManager.setStyle(e,"opacity",.3)}},AvoidJS.ui.Format=new function(){var e=this;this.isEmptyString=function(e){return null==e||0==e.trim().length},this.isEmptyTagsStr=function(e){return 0==e.trim().replace("-","").length},this.prepareTag=function(e){return e.toLowerCase().replace(/[[\]{}()*+?.,\\^$|#]/g,"").replace(/[\s_]/g,"-").trim()},this.directInput=function(t){return e.nl2br(e.escapeHtml(t))},this.nl2br=function(e){return e.replace(/\n/g,"<br/>")},this.OX=function(e){return e<10?"0"+e:e},this.escapeHtml=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}};