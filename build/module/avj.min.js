document.contains||(document.contains=function(e){for(;e.parentNode;)e=e.parentNode;return e===document}),Array.prototype.onEach=function(e,t){for(var o,i=this.length,r=0;r<this.length;r++,i--){var n=e(this[r],r,i-1);if(!1===n)break;t&&(o=t(n,o))}return o},Array.prototype.remove=function(e){var t=this.indexOf(e);t>-1&&this.splice(t,1)},Array.prototype.removeConditional=function(e){for(var t=0;t<this.length;t++)e(this[t],t)&&this.splice(t,1)},Array.prototype.condition=function(e){for(var t=0;t<this.length;t++)if(e(this[t],t))return!0;return!1},Array.prototype.shuffle=function(){var e,t,o=this.length;if(0==o)return this;for(;--o;)e=Math.floor(Math.random()*(o+1)),t=this[o],this[o]=this[e],this[e]=t;return this},Array.prototype.trimEach=function(){return this.map(function(e){return e.trim()})},Object.prototype.toArray=function(){var e=[];return this.onEach(function(t,o){e.push({key:o,value:t})}),e},Object.prototype.onEach=function(e,t){var o,i=0;for(var r in this)if(this.hasOwnProperty(r)){var n=e(this[r],r,i);if(!1===n)break;t&&(o=t(n,o)),i++}return o},Object.prototype.clone=function(){return JSON.parse(JSON.stringify(this))},Object.prototype.copy=function(e){e.onEach(function(e,t){this[t]=e})},Object.prototype.merge=function(e){var t={};for(var o in this)t[o]=this[o];for(var o in e)t[o]=e[o];return t},String.prototype.replaceAll=function(e,t){return this.replace(new RegExp(e,"g"),t)},String.prototype.splitTrim=function(e){return this.split(e).trim()},String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.escapeRegExp=function(){return this.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},String.prototype.escapeHTML=function(){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return this.replace(/[&<>"']/g,function(t){return e[t]})},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),String.prototype.trimChar=function(e){e=AvoidJS.$.OR(e," ");var t=this.escapeRegExp(),o=new RegExp("^["+e+"]+|["+e+"]+$","g");return t.replace(o,"")},String.prototype.isNumeric=function(){return parseFloat(this)==this},String.prototype.repeat||(String.prototype.repeat=function(e){return new Array(e+1).join(this)});var AvoidJS={$:{},conf:{},core:{Logger:{},Threader:{},Timeout:{}},Storage:{},Remember:{},Eventer:{},Events:{},Templater:{},ui:{Effects:{},Manager:{},Format:{}},cmd:{},conf:{version:"0.0",attrs:{templater:{load:"avj-load-templates",template:"avj-template",action:"avj-action",digested:"avj-digested",preserveContent:"avj-preserve-content",contentPreserved:"avj-content-preserved"},macros:{def:"avj-macros",apply:function(e){return"avj-apply-"+e},applied:function(e){return"avj-"+e+"-applied"}},actions:{prop:function(e,t){return"avj-"+e.toLowerCase()+"-"+t},data:function(e){return"avj-"+e.toLowerCase()+"-data-"},formValidation:"avj-form-validation"}}}};AvoidJS.$.OR=function(e,t){return null!==e&&void 0!==e?e:t},AvoidJS.$.getBool=function(e){if(void 0===e||null===e)return!1;if(!0===e||!1===e)return e;switch(e.toString().toLowerCase().trim()){case"true":case"yes":case"1":case"on":return!0;case"false":case"no":case"0":case null:return!1;default:return Boolean(e)}},AvoidJS.Events={registeredEvents:{},registerEvents:function(e){var t=null;if(AvoidJS.Events.onEach(function(o,i){o===e&&(t=i)}),!t)throw"Cannot register events - no namespace found.";e.onEach(function(o,i){e[i]=[t,i].join("."),AvoidJS.Events.registeredEvents[e[i]]=[e[i]]})},isEventSupported:function(e){return void 0!==AvoidJS.Events.registeredEvents[e]},ifEventSupported:function(e,t){AvoidJS.Events.isEventSupported(e)?t():AvoidJS.Logger.error("EventsManager: event with name '"+e+"' not supported.")}},AvoidJS.Eventer={listeners:{},history:{},subscribe:function(e,t,o){o={id:null,subtype:null,once:!1,noQ:!1}.merge(o),AvoidJS.Events.ifEventSupported(e,function(){AvoidJS.Eventer.listeners[e]||(AvoidJS.Eventer.listeners[e]={}),o.id||(o.id=AvoidJS.Eventer.generateId(e)),AvoidJS.Logger.info(o.id),AvoidJS.Eventer.listeners[e][o.id]={func:function(e,i,r){if(!o.subtype||o.subtype==r){var n=t(e,i,r);(o.once||!1===n)&&AvoidJS.Eventer.unsubscribe(i,o.id)}},options:o}})},subscribeMulti:function(e,t,o){e.onEach(function(e){AvoidJS.Eventer.subscribe(e,t,o)})},generateId:function(e){var t=0;for(this.listeners[e]||(this.listeners[e]={});void 0!==this.listeners[e][e+t];)t++;return e+t},subscribeOnce:function(e,t,o){o={once:!0}.merge(o),this.subscribe(e,t,o)},unsubscribe:function(e,t){AvoidJS.Logger.info("Unsubscribe: "+t),this.listeners[e]&&this.listeners[e][t]&&delete this.listeners[e][t]},unsubscribeAll:function(e){this.listeners[e]&&(delete this.listeners[e],this.listeners[e]={})},unsubscribeEvery:function(e){e.onEach(function(e){AvoidJS.Eventer.unsubscribeAll(e)})},getListeners:function(e){return AvoidJS.$.OR(AvoidJS.Eventer.listeners[e],{})},fire:function(e,t,o){o={noQ:!1,subtype:""}.merge(o),AvoidJS.Events.ifEventSupported(e,function(){AvoidJS.Eventer.history[e]=AvoidJS.$.OR(AvoidJS.Eventer.history[e],{}),AvoidJS.Eventer.history[e][o.subtype]={data:t,options:o},AvoidJS.Eventer.getListeners(e).onEach(function(i){o.noQ||i.options.noQ?i.func(t,e,o.subtype):AvoidJS.core.Threader.putInQueue(function(){i.func(t,e,o.subtype)})})})},refire:function(e,t){t||(t=""),AvoidJS.Eventer.history[e]&&AvoidJS.Eventer.history[e][t]&&AvoidJS.Eventer.fire(e,AvoidJS.Eventer.history[e][t].data,AvoidJS.Eventer.history[e][t].options)},wasFired:function(e,t){return t||(t=""),AvoidJS.Eventer.history[e]&&AvoidJS.Eventer.history[e][t]}},AvoidJS.Logger={options:{info:!1,error:!0},info:function(e){this.options.info&&console.log(e)},error:function(e){this.options.error&&console.log(e)}},AvoidJS.core.Threader={putInQueue:function(e,t){AvoidJS.core.Timeout.set(function(){var o=e();t&&t(o)},1)},run:function(e,t){if(t||(t={callback:null,inQ:!1}),t.inQ)AvoidJS.core.Timeout.set(function(){var o=e();t.callback&&t.callback(o)},1);else{var o=e();t.callback&&t.callback(o)}}},AvoidJS.core.Timeout=new function(){this.reset=function(e){null!=e&&(clearTimeout(e),e=null)},this.set=function(e,t){var o=setTimeout(function(){e(),o=null},t);return o}},AvoidJS.Ajax={expectedStatuses:[],objectToHttpParam:function(e,t){var o="";for(var i in e){var r=e[i];if(t&&(i=t+"["+i+"]"),"[object Array]"===Object.prototype.toString.call(r))for(var n=0;n<r.length;n++){var a=r[n];o+="string"==typeof a?encodeURIComponent(i)+"[]="+encodeURIComponent(a)+"&":this.objectToHttpParam(a,i+"["+n+"]")}else"[object Object]"===Object.prototype.toString.call(r)?o+=this.objectToHttpParam(r,i):o+=encodeURIComponent(i)+"="+encodeURIComponent(r)+"&"}return o},isSuccessStatus:function(e){return e.status>=200&&e.status<300||-1!==AvoidJS.Ajax.expectedStatuses.indexOf(e.status)},Invoke:function(e,t,o){var i,r=null;return(i=window.XMLHttpRequest?new window.XMLHttpRequest:new window.ActiveXObject("Microsoft.XMLHTTP")).onreadystatechange=function(){if(4==i.readyState)if(AvoidJS.Ajax.isSuccessStatus(i))AvoidJS.Ajax.onLoad(i,e,t,o);else{if(429==i.status){var r=i.getResponseHeader("Retry-After");r||(r=2e3),Timeout.set(function(){AvoidJS.Ajax.Invoke(e,t,o)},r)}try{throw AvoidJS.Eventer.fire(AvoidJS.Events.XMLHTTP.requestFailed,{xmlhttp:i},{noQ:!0}),"Invalid response."}catch(e){o&&o(e,i)}}},i.onabort=function(){i.aborted=!0,AvoidJS.Logger.info("Request was aborted: "+i.userData.url+"\nData: "+JSON.stringify(i.userData.data))},i.onloadend=function(){AvoidJS.Logger.info("Request was loaded: "+i.userData.url+"\nData: "+JSON.stringify(i.userData.data))},i.userData=e,e.headers&&performOnElsList(e.headers,function(e){i.setRequestHeader(e.key,e.value)}),e.type&&"POST"==e.type.toString().toUpperCase()?(i.open(e.type,e.url,!0),e.data&&(r=this.objectToHttpParam(e.data),i.setRequestHeader("Content-type","application/x-www-form-urlencoded")),e.formData&&(r=e.formData)):i.open(e.type,e.url+this.objectToHttpParam(e.data),!0),AvoidJS.Eventer.fire(AvoidJS.Events.XMLHTTP.beforeSend,{xmlhttp:i},{noQ:!0}),i.send(r),i},onLoad:function(e,t,o,i){if(!e.aborted){AvoidJS.Eventer.fire(AvoidJS.Events.XMLHTTP.onLoad,{xmlhttp:e},{noQ:!0});var r=e.responseText;try{t.processor&&(r=t.processor(e.responseText)),o&&o(r,e.status)}catch(t){AvoidJS.Logger.error(t),AvoidJS.Logger.error(e),AvoidJS.Eventer.fire(AvoidJS.Events.XMLHTTP.invalidResponse,{xmlhttp:e,response:r},{noQ:!0}),i&&i(t,e)}}},abourtRequest:function(e){return e.aborted=!0,e.abort(),e=null}},AvoidJS.Ajax.Request=function(e,t,o,i,r){this.url=e,this.type=AvoidJS.$.OR(t,"GET"),this.data=o,this.formData=i,this.processor=r},AvoidJS.Events.XMLHTTP={onLoad:"onLoad",beforeSend:"beforeSend",requestFailed:"requestFailed",invalidResponse:"invalidResponse"},AvoidJS.Events.registerEvents(AvoidJS.Events.XMLHTTP),AvoidJS.Remember={my:{},defaults:{},typesSupport:{json:{to:function(e){return JSON.stringify(e)},from:function(e,t){if(e)try{return JSON.parse(e)}catch(e){}return t}}},types:{userChatsFilter:"json"},please:function(e,t){this.types[e]&&(t=this.typesSupport[this.types[e]].to(t)),AvoidJS.Storage.save(e,t)},that:function(e,t){var o=AvoidJS.Storage.get(e);return"undefined"===o||void 0===o||null===o?(o=AvoidJS.$.OR(t,AvoidJS.Remember.defaults[e]),AvoidJS.Remember.please(e,o)):this.types[e]&&(o=this.typesSupport[this.types[e]].from(o,t)),o},forget:function(e){AvoidJS.Storage.remove(e)}},AvoidJS.Storage={types:{},storage:null,init:function(e){this.storage=e},save:function(e,t){this.storage.save(e,t)},get:function(e){return this.storage.get(e)},remove:function(e){this.storage.remove(e)}},AvoidJS.Storage.types.CookieStorage={get:function(e){return e&&decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},save:function(e,t){return this._save(e,t,1/0,"/")},_save:function(e,t,o,i,r,n){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var a="";if(o)switch(o.constructor){case Number:a=o===1/0?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+o;break;case String:a="; expires="+o;break;case Date:a="; expires="+o.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+a+"; domain="+(r||"."+document.domain)+(i?"; path="+i:"/")+(n?"; secure":""),!0},remove:function(e,t,o){if(!this.has(e))return!1;var i=new Date;return i.setTime(-1),document.cookie=encodeURIComponent(e)+"=; expires="+i.toGMTString()+";",!0},has:function(e){return!!e&&new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)},keys:function(){for(var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/),t=e.length,o=0;o<t;o++)e[o]=decodeURIComponent(e[o]);return e}},AvoidJS.Storage.types.LocalStorage={save:function(e,t){window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},remove:function(e){window.localStorage.removeItem(e)}},AvoidJS.Templater={preservedContent:[],init:function(){AvoidJS.Templater.GarbageCollector.init()},digest:function(e,t){AvoidJS.Templater.Manager.retrieveTemplates(e),AvoidJS.Templater.MacrosManager.retrive(e),AvoidJS.ui.DOM.getAllByAttribute(e,AvoidJS.conf.attrs.templater.preserveContent).onEach(function(e){AvoidJS.ui.DOM.elHassAttr(e,AvoidJS.conf.attrs.templater.contentPreserved)||(AvoidJS.Templater.preservedContent.push({el:e,content:AvoidJS.ui.DOM.getHTML(e)}),AvoidJS.ui.DOM.clearEl(e),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.contentPreserved,!0))}),AvoidJS.Templater.MacrosManager.available.onEach(function(o,i){AvoidJS.ui.DOM.getAllByAttribute(e,o.attr).onEach(function(e){if(0==AvoidJS.ui.DOM.elHassAttr(e,AvoidJS.conf.attrs.macros.applied(i))){var r=AvoidJS.Templater.MacrosManager.available[i];r.actions.onEach(function(i){var n=new AvoidJS.Templater.Action(i.name,e,t,i.alias,r.el,{macros:{value:AvoidJS.ui.DOM.getElAttr(e,o.attr)}});AvoidJS.Templater.runAction(n)}),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.macros.applied(i),!0)}})}),AvoidJS.ui.DOM.getAllByAttribute(e,AvoidJS.conf.attrs.templater.action).onEach(function(e){AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.digested)||(AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.digested,!0),AvoidJS.Templater.processActions(AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.action),e,t))}),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.elementDigested,{el:e}),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.garbageCollectorDeactivateZombies)},processActions:function(e,t,o,i){AvoidJS.Templater.ActionsParser.retriveActions(e,t,o,i).onEach(function(e){AvoidJS.Templater.runAction(e)})},runAction:function(e){AvoidJS.Templater.actions[e.action]||AvoidJS.Logger.error("Action ["+e.action+"] is not supported. "),AvoidJS.Templater.GarbageCollector.addAction(e),AvoidJS.Templater.performPreAction(e),e.wait?AvoidJS.Templater.wait._process(e):AvoidJS.Templater.perform(e)},performPreAction:function(e){AvoidJS.Templater.actions[e.action]._pre&&AvoidJS.Templater.actions[e.action]._pre(e)},perform:function(e){if(AvoidJS.$.getBool(e.getProp("debug")),document.contains(e.el)){if(e.prepare(),!e.if||AvoidJS.$.getBool(new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateCondition(e.if))){AvoidJS.Eventer.fire(AvoidJS.Events.Templater.performingAction,{action:e}),e.before&&AvoidJS.Templater.processActions(e.before,e.el,e.getData(),e.parentEl);var t=AvoidJS.Templater.actions[e.action].perform(e);AvoidJS.Templater.actions[e.action]._post&&AvoidJS.Templater.actions[e.action]._post(e,t),AvoidJS.Eventer.fire(AvoidJS.Events.Templater.actionPerformed,{action:e}),e.after&&AvoidJS.Templater.processActions(e.after,e.el,e.getData(),e.parentEl)}else e.else&&AvoidJS.Templater.processActions(e.else,e.el,e.getData(),e.parentEl);e.awaits||(e.active=!1)}else e.valid=!1;AvoidJS.Eventer.fire(AvoidJS.Events.Templater.garbageCollectorCleanUp)},wait:{_process:function(e){AvoidJS.Templater.ActionsParser.retriveNameWithAlliases(e.wait).onEach(function(t){AvoidJS.Templater.wait[t.name]?AvoidJS.Templater.wait[t.name](e,t.alias):AvoidJS.Logger.error("When type ["+t.name+"] is not supported. ")})},now:function(e,t){AvoidJS.Templater.perform(e)},event:function(e,t){var o=this,i=e.getProp(t+"-when").split(",").trimEach();this.subscribe=function(e,t,i){var r={repeat:t.getProp(i+"-repeat","repeat"),subtype:t.getProp(i+"-subtype")};AvoidJS.Eventer.subscribe(e,function(e,n,a){t.setData("event",e),t.setData("_event",{name:n,subtype:a}),t.awaits="repeat"===r.repeat,AvoidJS.Templater.perform(t),t.valid&&t.awaits&&o.subscribe(n,t,i)},{subtype:r.subtype,once:!0})},i.onEach(function(i){o.subscribe(i,e,t)})},trigger:function(e,t){var o=e.getProp(t+"-repeat","repeat");AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.triggerAction,function(i,r,n){e.setData("event",i.data),e.setData("trigger",i.action),e.setData("_event",{name:r,subtype:n}),e.awaits="repeat"===o,AvoidJS.Templater.perform(e),e.valid&&e.awaits&&AvoidJS.Templater.wait.trigger(e,t)},{subtype:e.id,once:!0})},user:function(e,t){var o={when:e.getProp(t+"-when"),noDef:e.getProp(t+"-noDef"),confirm:e.getProp(t+"-confirm")};AvoidJS.ui.DOM.addEvent(e.el,o.when,function(t){o.noDef&&t.preventDefault(),e.setData("_event",t),o.confirm?PageAlerts.confirm(o.confirm,function(){AvoidJS.Templater.perform(e)}):AvoidJS.Templater.perform(e)})},window:function(e,t){var o={when:e.getProp(t+"-when"),noDef:e.getProp(t+"-noDef")};AvoidJS.ui.DOM.addEvent(window,o.when,function(t){o.noDef&&t.preventDefault(),e.setData("_event",t),AvoidJS.Templater.perform(e)})},timeout:function(e,t){AvoidJS.core.Timeout.set(function(){AvoidJS.Templater.perform(e)},e.getProp(t))}}},AvoidJS.Templater.Action=function(e,t,o,i,r,n){var a=this;this.valid=!0,this.active=!0,this.awaits=!1,this.el=t,this.action=e,this.alias=AvoidJS.$.OR(i,e),this.parentEl=r,this.prepare=function(){this.parentEl&&this._retrieveDataAttrbs(this.parentEl),this._retrieveDataAttrbs(this.el),this.setData("_global",AvoidJS.Templater.Glob.data),this.setData("_elContent",AvoidJS.ui.DOM.getHTML(t).trim())},this._retrieveDataAttrbs=function(e){var t=AvoidJS.conf.attrs.actions.data(this.alias);e.attributes.onEach(function(e){if(0===e.name.indexOf(t)){var o=e.name.replace(t,"").split("-")[0];a.data[o]=a.getProp("data-"+o)}})},this.getProp=function(e,t){e=e.toLowerCase();var o=this._retrievePropFromEl(this.el,e);return null===o&&this.parentEl&&(o=this._retrievePropFromEl(this.parentEl,e)),AvoidJS.$.OR(o,t)},this._retrievePropFromEl=function(e,t){var o=null,i=AvoidJS.conf.attrs.actions.prop(this.alias,t),r=AvoidJS.ui.DOM.getElAttr(e,i+"-expr");return r?o=new AvoidJS.Templater.Temparser(null,this.getData()).evaluate(r):AvoidJS.ui.DOM.elHassAttr(e,i)&&(o=AvoidJS.ui.DOM.getElAttr(e,i)),o},this.getData=function(e){return new AvoidJS.Templater.Temparser(null,this.data).parseValue(AvoidJS.$.OR(e,this.context))},this.setData=function(e,t){this.data[e]=t},this.data={data:AvoidJS.$.OR(o,{}),action:a},n&&n.onEach(function(e,t){a.data[t]=e}),this.context=this.getProp("context","data"),this.id=this.getProp("id",this.action),this.wait=this.getProp("wait"),this.if=this.getProp("if"),this.else=this.getProp("else"),this.before=this.getProp("before"),this.after=this.getProp("after")},AvoidJS.Templater.ActionsParser={retriveActions:function(e,t,o,i){var r=[];return this.retriveNameWithAlliases(e).onEach(function(e){r.push(new AvoidJS.Templater.Action(e.name,t,o,e.alias,i))}),r},retriveNameWithAlliases:function(e){var t=[];return e.split(",").trimEach().onEach(function(e){var o=e,i=o,r=e.split("=");r.length>1&&(i=r[0],o=r[1]),t.push({name:o,alias:i})}),t}},AvoidJS.Templater.Glob={data:{},get:function(e,t,o){var i=o;return this.data[e]?(i=this.data[e],t&&(i=this.data[e][t])):t?this.set(e,t,i):this.data[e]=i,i},set:function(e,t,o){this.data[e]||(this.data[e]={}),this.data[e][t]=o}},AvoidJS.Templater.GarbageCollector={activeActions:[],init:function(){AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.garbageCollectorDeactivateZombies,function(){AvoidJS.Templater.GarbageCollector.deactivateZombies()}),AvoidJS.Eventer.subscribe(AvoidJS.Events.Templater.garbageCollectorCleanUp,function(){AvoidJS.Templater.GarbageCollector.collectGarbage()})},addAction:function(e){this.activeActions.push(e)},deactivateZombies:function(){this.activeActions.onEach(function(e,t){0==document.contains(e.el)&&(e.valid=!1,e.active=!1)})},collectGarbage:function(){for(var e=this.activeActions.length;e--&&-1!==e;)!1===this.activeActions[e].active&&this.activeActions.splice(e,1)}},AvoidJS.Events.Templater={triggerAction:"triggerAction",elementDigested:"elementDigested",performingAction:"performingAction",actionPerformed:"actionPerformed",garbageCollectorDeactivateZombies:"garbageCollectorDeactivateZombies",garbageCollectorCleanUp:"garbageCollectorCleanUp"},AvoidJS.Events.registerEvents(AvoidJS.Events.Templater),AvoidJS.Templater.actions={void:{perform:function(){}},trigger:{perform:function(e){e.getProp("action","").split(",").trimEach().onEach(function(t){AvoidJS.Eventer.fire(AvoidJS.Events.Templater.triggerAction,{data:e.getData(),action:e},{noQ:!0,subtype:t})})}},retrigger:{perform:function(e){e.getProp("action","").split(",").trimEach().onEach(function(e){AvoidJS.Eventer.refire(AvoidJS.Events.Templater.triggerAction,e)})}},execute:{perform:function(e){e.getProp("func","").split(";").trimEach().onEach(function(t){new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateExpression(t)})}},fire:{perform:function(e){return AvoidJS.Eventer.fire(e.getProp("event"),null,{noQ:!0,subtype:e.getProp("subtype")})}},condition:{perform:function(e){var t=e.getProp("expr",""),o=e.getProp("true"),i=e.getProp("false");AvoidJS.$.getBool(new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateCondition(t))?o&&AvoidJS.Templater.processActions(o,e.el,e.getData(),e.parentEl):i&&AvoidJS.Templater.processActions(i,e.el,e.getData(),e.parentEl)}},include:{perform:function(e){AvoidJS.ui.DOM.setHTML(e.el,AvoidJS.Templater.Manager.getHTML(e.getProp("template"))),AvoidJS.Templater.digest(e.el,e.getData())}},draw:{_pre:function(e){e.html=AvoidJS.ui.DOM.getHTML(e.el);var t=e.getProp("placeholder");t&&AvoidJS.ui.DOM.setHTML(e.el,t)},perform:function(e){return new AvoidJS.Templater.Temparser(this.__getContent(e),e.getData(),null).format()},_post:function(e,t){AvoidJS.$.getBool(e.getProp("clear",!0))&&AvoidJS.ui.DOM.clearEl(e.el);var o=e.getProp("above",!1);AvoidJS.ui.DOM.addNodeFromHTML(e.el,t,o),AvoidJS.Templater.digest(e.el,e.getData())},__getContent:function(e){if(e.getProp("template"))return AvoidJS.Templater.Manager.getHTML(e.getProp("template"));if(e.getProp("page"))return AppPage.getPageHTML(e.getProp("page"));if(e.getProp("content"))return e.getProp("content");var t=e.html;return AvoidJS.Templater.preservedContent.onEach(function(o){if(o.el===e.el)return t=o.content,!1}),t}},drawEvery:{_pre:function(e){return AvoidJS.Templater.actions.draw._pre(e)},perform:function(e){var t={clear:AvoidJS.$.getBool(e.getProp("clear",!0)),alias:e.getProp("alias","val"),sep:e.getProp("sep",""),sepEvery:parseInt(e.getProp("sepEvery",1)),isAbove:e.getProp("above",!1),every:e.getProp("every"),everyIf:e.getProp("everyIf",!1),everyAfter:e.getProp("everyAfter",!1),ifNone:e.getProp("ifNone")},o=new AvoidJS.Templater.Temparser(null,e.getData()).evaluateExpression(t.every);if(o.length>0)return t.clear&&AvoidJS.ui.DOM.clearEl(e.el),o.onEach(function(o,i,r){var n={parent:e.getData(),val:o,index:i};if(n[t.alias]=o,e.setData("_item",n),!t.everyIf||AvoidJS.$.getBool(new AvoidJS.Templater.Temparser(null,n,null).evaluateCondition(t.everyIf))){var a=r>0&&(i+1)%t.sepEvery==0?t.sep:"",s=new AvoidJS.Templater.Temparser(AvoidJS.Templater.actions.draw.__getContent(e),n,null).format();AvoidJS.core.Threader.run(function(){AvoidJS.ui.DOM.addNodeFromHTML(e.el,s+a,t.isAbove),AvoidJS.Templater.digest(e.el,n),t.everyAfter&&AvoidJS.Templater.processActions(t.everyAfter,e.el,n,e.parentEl)},{inQ:!1,callback:null})}},function(e,t){return AvoidJS.$.OR(t,"")+e});t.ifNone&&AvoidJS.ui.DOM.setHTML(e.el,t.ifNone)}},setHTML:{perform:function(e){AvoidJS.ui.DOM.setHTML(e.el,e.getProp("value"))}},addHTML:{perform:function(e){AvoidJS.ui.DOM.addNodeFromHTML(e.el,e.getProp("value"),e.getProp("above"))}},clearHTML:{perform:function(e){AvoidJS.ui.DOM.clearEl(e.el,e.getProp("value"))}},show:{perform:function(e){AvoidJS.ui.DOM.showEl(e.el,e.getProp("display"))}},hide:{perform:function(e){AvoidJS.ui.DOM.hideEl(e.el)}},enable:{perform:function(e){AvoidJS.ui.DOM.enEl(e.el)}},disable:{perform:function(e){AvoidJS.ui.DOM.disEl(e.el)}},focus:{perform:function(e){AvoidJS.ui.DOM.setFocus(e.el)}},placeholder:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"placeholder",e.getProp("text"))}},checked:{perform:function(e){AvoidJS.ui.DOM.setChecked(e.el,AvoidJS.$.getBool(e.getProp("value")))}},selected:{perform:function(e){AvoidJS.ui.DOM.setSelectedOption(e.el,e.getProp("value"))}},addClass:{perform:function(e){AvoidJS.ui.DOM.addClassToEl(e.el,e.getProp("class"))}},removeClass:{perform:function(e){AvoidJS.ui.DOM.removeClassFromEl(e.el,e.getProp("class"))}},switchClass:{perform:function(e){AvoidJS.ui.DOM.switchClassOnEl(e.el,e.getProp("class"))}},setValue:{perform:function(e){AvoidJS.ui.DOM.setValue(e.el,e.getProp("value",""))}},resetValue:{perform:function(e){AvoidJS.ui.DOM.resetValue(e.el)}},select:{perform:function(e){AvoidJS.ui.DOM.select(e.el)}},restorableValue:{perform:function(e){var t=e.getProp("storageKey");AvoidJS.ui.DOM.setValue(e.el,AvoidJS.Remember.that(t,AvoidJS.ui.DOM.getValue(e.el))),AvoidJS.Eventer.subscribeOnce(AvoidJS.Events.PageDirector.pageUnloaded,function(){AvoidJS.Remember.please(t,AvoidJS.ui.DOM.getValueTrimmed(e.el))})}},rememberGlob:{perform:function(e){AvoidJS.Remember.please(e.getProp("remember"),AvoidJS.Templater.Glob.get(e.getProp("glob")))}},setSrc:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"src",e.getProp("value"))}},setHref:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"href",e.getProp("href"))}},toggleDisplay:{perform:function(e){AvoidJS.ui.DOM.toggleElDisplay(e.el,e.getProp("display"))}},adaptHeight:{perform:function(e){AvoidJS.ui.DOM.adaptElHeight(e.el)}},autoHeight:{perform:function(e){AvoidJS.ui.DOM.adaptiveHeight(e.el)}},scrollTop:{perform:function(e){AvoidJS.ui.DOM.scrollTop(e.el)}},scrollIntoView:{perform:function(e){AvoidJS.ui.DOM.scrollIntoView(e.el)}},scrollDown:{perform:function(e){AvoidJS.ui.DOM.scrollDown(e.el)}},preserveScroll:{perform:function(e){AvoidJS.ui.DOM.setElAttr(e.el,"tmp-preserveScroll-value",e.el.scrollHeight-e.el.scrollTop)}},restoreScroll:{perform:function(e){var t=AvoidJS.ui.DOM.getElAttr(e.el,"tmp-preserveScroll-value");void 0!==t&&(AvoidJS.ui.DOM.setScrollTop(e.el,e.el.scrollHeight-t),AvoidJS.ui.DOM.removeElAttr(e.el,"tmp-preserveScroll-value"))}},noScrollingPropagation:{perform:function(e){AvoidJS.ui.DOM.preventScrollPropagation(e.el)}},processForm:{perform:function(e){var t={},o=new FormData(e.el);e.el.querySelectorAll("[name]").onEach(function(e){var o=AvoidJS.ui.DOM.getElAttr(e,"name"),i=AvoidJS.ui.DOM.getValue(e);t[o+"_array"]||(t[o+"_array"]=[]),"checkbox"===AvoidJS.ui.DOM.getElAttr(e,"type")?e.checked?(t[o]="on",t[o+"_array"].push(i)):t[o]="off":(t[o]=i,t[o+"_array"].push(i))}),e.setData("formData",t),e.setData("form",o);var i=!0;AvoidJS.ui.DOM.getAllByAttribute(e.el,AvoidJS.conf.attrs.actions.formValidation).onEach(function(t){var o=AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.actions.formValidation),r=new AvoidJS.Templater.Temparser(null,e.getData(),null).evaluateExpression(o)(AvoidJS.ui.DOM.getValueTrimmed(t));if(!r.valid)return i=!1,PageDirector.showOperationError(r.message),!1});var r=e.getProp("ifValid");i&&r&&AvoidJS.Templater.processActions(r,e.el,e.getData(),e.parentEl)}},fadeOut:{perform:function(e){UIEffects.fadeOut(e.el)}},setStyle:{perform:function(e){AvoidJS.ui.DOM.setStyle(e.el,e.getProp("style"),e.getProp("value"))}},json2html:{perform:function(e){AvoidJS.ui.DOM.json2html(e.el)}}},AvoidJS.Templater.MacrosManager={available:{},retrive:function(e){AvoidJS.ui.DOM.getAllByAttribute(e,AvoidJS.conf.attrs.macros.def).onEach(function(e){if(!AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.digested)){var t=AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.macros.def);AvoidJS.Templater.MacrosManager.available[t]=new AvoidJS.Templater.Macros(t,e),AvoidJS.ui.DOM.setElAttr(e,AvoidJS.conf.attrs.templater.digested,!0)}})}},AvoidJS.Templater.Macros=function(e,t){this.name=e,this.attr=AvoidJS.conf.attrs.macros.apply(e),this.el=t,this.actions=AvoidJS.Templater.ActionsParser.retriveNameWithAlliases(AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.templater.action))},AvoidJS.Templater.Manager=new function(){var e=this;this.loadedTemplates={},this.templateRelations={},this.init=function(e){var t=AvoidJS.ui.DOM.getAllByAttribute(e,AvoidJS.conf.attrs.templater.load);if(t.length>0){var o=[];t.onEach(function(e){var i=AvoidJS.ui.DOM.getElAttr(e,AvoidJS.conf.attrs.templater.load);AvoidJS.Ajax.Invoke(new AvoidJS.Ajax.Request(i),function(r){AvoidJS.ui.DOM.setHTML(e,r),o.push(i),o.length==t.length&&AvoidJS.Eventer.fire(AvoidJS.Events.TemplatesManager.loaded,null,{noQ:!0})})})}else AvoidJS.Eventer.fire(AvoidJS.Events.TemplatesManager.loaded,null,{noQ:!0})},this.retrieveTemplates=function(t,o){AvoidJS.ui.DOM.getAllByAttribute(t,AvoidJS.conf.attrs.templater.template).onEach(function(t){e.retrieveTemplate(t,o)})},this.retrieveTemplate=function(t,o){var i=AvoidJS.ui.DOM.getElAttr(t,AvoidJS.conf.attrs.templater.template);void 0===e.loadedTemplates[i]&&(e.retrieveTemplates(t,o),e.loadedTemplates[i]=AvoidJS.ui.DOM.getHTML(t),o&&(e.templateRelations[o]=i),AvoidJS.ui.DOM.removeEl(t))},this.getHTML=function(e){if(void 0===this.loadedTemplates[e])throw"Cannot find template: '"+e+"'";return this.loadedTemplates[e]},this.format=function(e,t){return new AvoidJS.Templater.Temparser(this.getHTML(e),t,e).format()}},AvoidJS.Events.TemplatesManager={loaded:"loaded"},AvoidJS.Events.registerEvents(AvoidJS.Events.TemplatesManager),AvoidJS.Templater.Temparser=function(e,t,o){var i=this;return this.content=e,this.name=o,this.data=t,this.format=function(){return this.content.replace(new RegExp("{{(.[^{{]+)}}","g"),function(e,t){var o=i.evaluate(t,e);return AvoidJS.$.OR(o,"")}).trim()},this.evaluate=function(e,t){var o=null,r=e.split("?").trimEach();if(r.length>1){var n=r[0],a=r[1],s=null,l=r[1].split(":").trimEach();l.length>1&&(a=l[0],s=l[1]),i.evaluateCondition(n)?a&&(o=i.evaluate(a)):s&&(o=i.evaluate(s))}else o=i.evaluateCondition(r[0],t);return o},this.evaluateCondition=function(e){var t=!1,o=e.split(/\sand\s/).trimEach(),r=e.split(/\sor\s/).trimEach();if(o.length>1)for(var n=0;n<o.length;n++){if(!i.evaluateCondition(o[n])){t=!1;break}t=!0}else if(r.length>1){for(r=e.split(" or ").trimEach(),n=0;n<r.length;n++)if(i.evaluateCondition(r[n])){t=!0;break}}else if(null===e.match(/^[\"'].*[\"']$/g)){var a=[];AvoidJS.Templater.Temparser.comparisons._map.onEach(function(e,t){a.push(e)});var s=e.match("(.+)("+a.join("|")+")(.+)");if(s){s=s.trimEach();var l=i.evaluateExpression(s[1]),c=i.evaluateExpression(s[3]),u=AvoidJS.Templater.Temparser.comparisons._find(s[2]);u?t=AvoidJS.Templater.Temparser.comparisons[u](l,c):AvoidJS.Logger.error("Tempater.comparison: ["+s[1]+"] not found.")}else t=i.evaluateExpression(e,!1)}else t=e.replace(/^[\"']|[\"']$/g,"");return t},this.evaluateExpression=function(e,t){var o=t,r=e.match(/(.[^(]+)\(?/),arguments=e.match(/[(](.*)[)]/);if(r&&r.length>0)if(arguments&&arguments.length>0){var n=i.parseDataExpression(r[1],void 0),a=i.parseExpressionArguments(arguments[1]);void 0!==n.value&&(o=n.value.apply(n.obj,a))}else o=i.parseValue(r[1],t);else o=i.parseValue(e,t);return o},this.parseDataExpression=function(e,t){var o={obj:null,value:t};if(e){var r=i.data;e.split(".").trimEach().onEach(function(n,a){null!==r&&void 0!==r&&void 0!==r[n]?(o.obj=r,o.value=r=r[n]):0==a&&void 0!==window[n]?(o.obj=window,o.value=r=window[n]):(AvoidJS.Logger.error("AvoidJS.Templater.Temparser: ["+i.name+"] Cannot find data for ["+e+"]"),AvoidJS.Logger.error("== Defails =="),AvoidJS.Logger.error("Data Available: "),AvoidJS.Logger.error(i.data),AvoidJS.Logger.error("Content: "),AvoidJS.Logger.error(i.content),AvoidJS.Logger.error("== End =="),o.value=t)})}return o},this.parseExpressionArguments=function(e){var t=[];e&&e.split(",").onEach(function(e){t.push(i.parseValue(e))});return t},this.parseValue=function(e,t){var o=t;if(e)if(null!==(e=e.trim().replace(/&quot;/g,'"')).match(/^[\"']|[\"']$/g))o=e.replace(/^[\"']|[\"']$/g,"");else if(e.isNumeric())o=e;else switch(e){case"true":o=!0;break;case"false":o=!1;break;case"this":o=i.data;break;case"null":o=null;break;default:o=i.parseDataExpression(e,t).value}return o},this},AvoidJS.Templater.Temparser.comparisons={_find:function(e){for(var t in this._map)if(e==this._map[t])return t},_map:{notEqq:"!==",notEq:"!=",eqq:"===",eq:"==",moreOrEq:">=",more:">",lessOrEq:"<=",less:"<"},eq:function(e,t){return e==t},eqq:function(e,t){return e===t},notEq:function(e,t){return e!=t},notEqq:function(e,t){return e!==t},more:function(e,t){return parseFloat(e)>parseFloat(t)},moreOrEq:function(e,t){return parseFloat(e)>=parseFloat(t)},less:function(e,t){return parseFloat(e)<parseFloat(t)},lessOrEq:function(e,t){return parseFloat(e)<=parseFloat(t)}},AvoidJS.ui.DOM=new function(){var e=this;this.appendCSS=function(e,t){var o=document.createElement("style");o.type="text/css",o.innerHTML=t,e.appendChild(o)},this.appendJS=function(e,t){var o=document.createElement("script");o.type="text/javascript",o.innerHTML=t,e.appendChild(o)},this.appendJSsrc=function(e,t){var o=document.createElement("script");o.type="text/javascript",o.src=t,e.appendChild(o)},this.getAllByAttribute=function(e,t){return e.querySelectorAll("["+t+"]")},this.getById=function(e){return document.getElementById(e)},this.getAllElsByClass=function(e){return document.getElementsByClassName(e)},this.getChild=function(e,t){return e.querySelector(t)},this.getChildren=function(e,t){return e.querySelectorAll(t)},this.elHassAttr=function(e,t){return null!==e.getAttribute(t)},this.getElAttr=function(t,o,i){return e.elHassAttr(t,o)?t.getAttribute(o):i},this.setElAttr=function(e,t,o){return e.setAttribute(t,o)},this.removeElAttr=function(e,t){return e.removeAttribute(t)},this.elHasData=function(t,o){return e.elHassAttr(t,"data-"+o)},this.getElData=function(t,o,i){return e.getElAttr(t,"data-"+o,i)},this.setElData=function(t,o,i){return e.setElAttr(t,"data-"+o,i)},this.isElDisplay=function(e,t){return e.style.display==t},this.hideEl=function(e){return e.style.display="none",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elHidden,e),this},this.hideElsList=function(t){return e.getAllElsByClass(t).onEach(function(t){e.hideEl(t)}),this},this.showEl=function(e,t){return e.style.display=t||"block",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elDisplayed,e),this},this.conditionalDisplay=function(t,o,i){o?e.showEl(t,i):e.hideEl(t)},this.showElsList=function(t,o){e.getAllElsByClass(t).onEach(function(t){e.showEl(t,o)})},this.toggleElDisplay=function(e,t,o,i){return void 0===t&&(t="block"),this.isElDisplay(e,t)?(this.hideEl(e),i&&i()):(this.showEl(e,t),o&&o()),e.style.display},this.toggleElsListDisplay=function(t,o){return e.getAllElsByClass(t).onEach(function(t){e.toggleElDisplay(t,o)}),this},this.enEl=function(e){e.disabled=!1},this.disEl=function(e){e.disabled=!0},this.setFocus=function(e){e.focus()},this.getClass=function(e){return e.className},this.setClass=function(e,t){e.className=t},this.getHTML=function(e){return e.innerHTML},this.setHTML=function(e,t){e.innerHTML=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,e),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.addHTML=function(e,t,o){!0===o?e.innerHTML=t+e.innerHTML:e.innerHTML+=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,e),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.addNodeFromHTML=function(t,o,i,r){var n=document.createElement("span");for(e.setHTML(n,o),t.appendChild(n),(i||r)&&i&&(r=t.firstChild);n.childNodes.length>0;)t.insertBefore(n.childNodes[0],r);return e.removeEl(n),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t),t},this.setNodeFromHTML=function(t,o){for(;t.firstChild;)t.removeChild(t.firstChild);e.addNodeFromHTML(t,o),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t)},this.replaceElWithHTML=function(t,o){var i=e.addNodeFromHTML(t.parentNode,o,!1,t);return e.removeEl(t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.htmlChanged,t),AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,t),i},this.addChild=function(e,t){e.appendChild(t)},this.setChild=function(t,o){e.clearEl(t),e.addChild(t,o)},this.removeEl=function(e){e.parentNode&&e.parentNode.removeChild(e)},this.elHasParent=function(e,t){for(var o=e;null!=o;){if(o==t)return!0;o=o.parentNode}return!1},this.clearEl=function(t){e.setNodeFromHTML(t,"")},this.json2html=function(t){e.setHTML(t,JSON.parse(e.getHTML(t)))},this.setText=function(e,t){e.textContent=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.getValue=function(e){return e.value},this.getValueTrimmed=function(t){return e.getValue(t).trim()},this.setValue=function(e,t){e.value=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.appendValue=function(e,t){e.value+=t,AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.resetValue=function(e){e.value="",AvoidJS.Eventer.fire(AvoidJS.Events.DOM.elementContentChanged,e)},this.select=function(e){e.select()},this.isChecked=function(e){return e.checked},this.setChecked=function(e,t){void 0===t&&(t=!0),e.checked=AvoidJS.$.getBool(t)},this.setSelectedOption=function(t,o){t.options[e.getSelectorIndexOfOption(t,o)].selected=!0},this.getSelectedOption=function(t){return e.getSelectorOptionOfIndex(t,t.options.selectedIndex)},this.getSelectorIndexOfOption=function(t,o){var i=0;return t.options.onEach(function(t,r){e.getValue(t)==o&&(i=r)}),i},this.getSelectorOptionOfIndex=function(t,o){return e.getValueTrimmed(t.options[o])},this.scrollIntoView=function(e,t){if(e.scrollIntoView(),t&&AppInfo.isDesctop()){var o=window.scrollY;o&&window.scroll(0,o-Register.layout.getHeaderHeight(!0))}},this.getScrollTop=function(e){return e.scrollTop},this.setScrollTop=function(e,t){e.scrollTop=t},this.scrollTop=function(t){e.setScrollTop(t,0)},this.scrollDown=function(t){e.setScrollTop(t,t.scrollHeight)},this.getScrollDif=function(e){return e.scrollHeight-e.scrollTop},this.setScrollDif=function(e,t){e.scrollTop=e.scrollHeight-t},this.addClassToEl=function(e,t){if(e.className){this.removeClassFromEl(e,t);var o=e.className.split(" ");o.push(t),e.className=o.join(" ")}else e.className=t},this.removeClassFromEl=function(e,t){if(e.className){var o=t.split(" "),i=e.className.split(" "),r=new Array;i.forEach(function(e){-1===o.indexOf(e)&&r.push(e)}),e.className=r.join(" ")}},this.switchClassOnEl=function(t,o){o.split(" ").onEach(function(o){e.hasClass(t,o)?e.removeClassFromEl(t,o):e.addClassToEl(t,o)})},this.hasClass=function(e,t){return e.className&&e.className.indexOf(t)>-1},this.toggleElClass=function(e,t){this.hasClass(e,t)?this.removeClassFromEl(e,t):this.addClassToEl(e,t)},this.getStyle=function(e,t,o){var i=e.style[t];return o&&(i=parseInt(i)),i},this.setStyle=function(e,t,o,i){i&&(o+=i),e.style[t]=o},this.applyClassToCollectionOnCondition=function(e,t,o){for(var i=0;i<e.length;i++)o?this.addClassToEl(e[i],t):this.removeClassFromEl(e[i],t)},this.addEvent=function(e,t,o){t.split(" ").onEach(function(t){0>["[object Array]","[object NodeList]","[object HTMLCollection]"].indexOf(Object.prototype.toString.call(e))&&(e=[e]),e.onEach(function(e){var i=function(r){!1===o(r,e)&&e.removeEventListener(t,i)};e.addEventListener(t,i)})})},this.addEventNoDefault=function(t,o,i){e.addEvent(t,o,function(e){e.preventDefault(),i(e,t)})},this.removeChildren=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},this.getElComputedStyle=function(e,t,o){var i=window.getComputedStyle(e).getPropertyValue(t);return o?parseInt(i):i},this.preventScrollPropagation=function(t){var o=function(t){var o=this.scrollTop,i=this.scrollHeight,r=e.getElComputedStyle(this,"height",!0),n=t.wheelDelta,a=n>0,s=function(){return t.stopPropagation(),t.preventDefault(),t.returnValue=!1,!1};return!a&&-n>i-r-o?(this.scrollTop=i,s()):a&&n>o?(this.scrollTop=0,s()):void 0};t.addEventListener("mousewheel",o),t.addEventListener("DOMMouseScroll",o)},this.adaptElHeight=function(t){isFinite(e.getStyle(t,"height",!0))||e.setStyle(t,"height",0,"px");for(var o=e.getStyle(t,"height",!0);o>=0;--o)if(e.setStyle(t,"height",o,"px"),t.scrollHeight>t.clientHeight){e.setStyle(t,"height",t.scrollHeight,"px");break}},this.adaptiveHeight=function(t){e.setElData(t,"prev-length",e.getValue(t).length),e.addEvent(t,"input change",function(o){e.getValue(t).length!=e.getElAttr(t,"prev-length")&&(e.adaptElHeight(t),e.setElData(t,"prev-length",e.getValue(t).length))}),e.adaptElHeight(t),AvoidJS.Eventer.subscribe(AvoidJS.Events.DOM.elementContentChanged,function(e){t==t&&AvoidJS.ui.DOM.adaptElHeight(e)})}},AvoidJS.Events.DOM={htmlChanged:"htmlChanged",elementContentChanged:"elementContentChanged",elDisplayed:"elDisplayed",elHidden:"elHidden"},AvoidJS.Events.registerEvents(AvoidJS.Events.DOM),AvoidJS.ui.Format=new function(){this.nl2br=function(e){return e.replace(/\n/g,"<br/>")},this.OX=function(e){return e<10?"0"+e:e},this.escapeHtml=function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})}},AvoidJS.ui.Effects=new function(){this.fadeOut=function(e){UIManager.setStyle(e,"opacity",.3)}},AvoidJS.cmd={init:function(e){AvoidJS.Eventer.subscribe(AvoidJS.Events.TemplatesManager.loaded,function(){AvoidJS.Templater.digest(e),AvoidJS.Eventer.fire(AvoidJS.Events.AvoidJS.inited,null,{noQ:!0})}),AvoidJS.Templater.init(),AvoidJS.Templater.Manager.init(e)}},AvoidJS.Events.AvoidJS={inited:"inited"},AvoidJS.Events.registerEvents(AvoidJS.Events.AvoidJS),module.exports=AvoidJS;